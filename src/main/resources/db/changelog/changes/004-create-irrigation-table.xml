<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                   https://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <changeSet id="4" author="filip.petrovski">
        <sql>
            CREATE TABLE irrigation
            (
                id                  BIGSERIAL PRIMARY KEY,
                parcel_id           BIGINT      NOT NULL,
                scheduled_datetime  TIMESTAMP   NOT NULL,
                duration_minutes    INTEGER,
                water_amount_liters DOUBLE PRECISION,
                status              VARCHAR(50) NOT NULL,
                created_at          TIMESTAMP DEFAULT NOW(),
                updated_at          TIMESTAMP DEFAULT NOW(),

                CONSTRAINT fk_irrigation_parcel FOREIGN KEY (parcel_id)
                    REFERENCES parcel (id) ON DELETE CASCADE
            );
        </sql>

        <rollback>
            DROP TABLE IF EXISTS irrigation;
        </rollback>

    </changeSet>
</databaseChangeLog>